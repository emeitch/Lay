{"version":3,"sources":["webpack:///webpack/bootstrap a24e4bff588b71026c5c","webpack:///./src/uuid.js","webpack:///./src/link.js","webpack:///./src/store.js","webpack:///./src/app.js","webpack:///./src/ontology.js"],"names":["UUID","uuid","i","random","Math","toString","origin","constructor","generateUUIDString","Link","type","from","to","place","transaction","id","in","Store","links","link","set","tid","append","block","addLink","Date","undefined","console","assert","urn","match","store","get","add","log","transactionTimeUUID"],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA,mDAA2C,cAAc;;AAEzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;;;;;;;;;;;;;;;;IChEqBA,I;;;yCACS;AAC1B;AACA,UAAIC,OAAO,EAAX;AAAA,UAAeC,CAAf;AAAA,UAAkBC,MAAlB;AACA,WAAKD,IAAI,CAAT,EAAYA,IAAI,EAAhB,EAAoBA,GAApB,EAAyB;AACvBC,iBAASC,KAAKD,MAAL,KAAgB,EAAhB,GAAqB,CAA9B;;AAEA,YAAID,KAAK,CAAL,IAAUA,KAAK,EAAf,IAAqBA,KAAK,EAA1B,IAAgCA,KAAK,EAAzC,EAA6C;AAC3CD,kBAAQ,GAAR;AACD;AACDA,gBAAQ,CAACC,KAAK,EAAL,GAAU,CAAV,GAAeA,KAAK,EAAL,GAAWC,SAAS,CAAT,GAAa,CAAxB,GAA6BA,MAA7C,EAAsDE,QAAtD,CAA+D,EAA/D,CAAR;AACD;AACD,aAAOJ,IAAP;AACD;;;AAED,kBAAc;AAAA;;AACZ,SAAKK,MAAL,GAAc,KAAKC,WAAL,CAAiBC,kBAAjB,EAAd;AACD;;;;+BAMU;AACT,aAAO,KAAKF,MAAZ;AACD;;;wBANS;AACR,aAAO,cAAc,KAAKA,MAA1B;AACD;;;;;;kBArBkBN,I;;;;;;;;;;;;;;;;;;ACArB;;;;;;;;IAEqBS,I,GACnB,cAAYC,IAAZ,EAAkBC,IAAlB,EAAwBC,EAAxB,EAA4BC,KAA5B,EAAmCC,WAAnC,EAA+D;AAAA,MAAfC,EAAe,uEAAZ,oBAAY;;AAAA;;AAC7D,OAAKA,EAAL,GAAUA,EAAV;AACA,OAAKL,IAAL,GAAYA,IAAZ;AACA,OAAKC,IAAL,GAAYA,IAAZ;AACA,OAAKC,EAAL,GAAUA,EAAV;AACA,OAAKI,EAAL,GAAUH,KAAV;AACA,OAAKC,WAAL,GAAmBA,WAAnB;AACD,C;;kBARkBL,I;;;;;;;;;;;;;;;;;;;;ACFrB;;;;AACA;;;;AACA;;;;;;IAEqBQ,K;AACnB,mBAAc;AAAA;;AACZ,SAAKC,KAAL,GAAa,EAAb;AACD;;;;wBAEGH,E,EAAI;AACN,aAAO,KAAKG,KAAL,CAAWH,EAAX,CAAP;AACD;;;wBAEGA,E,EAAII,I,EAAM;AACZ,WAAKD,KAAL,CAAWH,EAAX,IAAiBI,IAAjB;AACD;;;2BAEMA,I,EAAM;AACX,WAAKC,GAAL,CAASD,KAAKJ,EAAd,EAAkBI,IAAlB;AACD;;;4BAEOT,I,EAAMC,I,EAAMC,E,EAAIC,K,EAAOQ,G,EAAK;AAClC,UAAMF,OAAO,mBAAST,IAAT,EAAeC,IAAf,EAAqBC,EAArB,EAAyBC,KAAzB,EAAgCQ,GAAhC,CAAb;AACA,WAAKC,MAAL,CAAYH,IAAZ;AACA,aAAOA,IAAP;AACD;;;gCAEWI,K,EAAO;AACjB;AACA,UAAMF,MAAM,oBAAZ;AACA,WAAKG,OAAL,gCAA8BH,GAA9B,EAAmC,IAAII,IAAJ,EAAnC,EAA+CC,SAA/C,EAA0DL,GAA1D;AACA,aAAOE,MAAMF,GAAN,CAAP;AACD;;;wBAEGX,I,EAAMC,I,EAAMC,E,EAAIC,K,EAAO;AAAA;;AACzB,aAAO,KAAKC,WAAL,CAAiB;AAAA,eACtB,MAAKU,OAAL,CAAad,IAAb,EAAmBC,IAAnB,EAAyBC,EAAzB,EAA6BC,KAA7B,EAAoCQ,GAApC,CADsB;AAAA,OAAjB,CAAP;AAGD;;;;;;kBAlCkBJ,K;;;;;;;;;;;;;;ACJrB;;;;AACA;;;;AACA;;;;;;AAEA;AACEU,UAAQC,MAAR,CAAe,qBAAWC,GAAX,CAAeC,KAAf,CAAqB,eAArB,CAAf;AACD;;AAED;AACE,MAAMC,QAAQ,qBAAd;AACA,MAAMrB,OAAO,oBAAb;AACA,MAAMC,OAAO,oBAAb;AACA,MAAMC,KAAK,oBAAX;AACA,MAAMO,OAAO,mBAAST,IAAT,EAAeC,IAAf,EAAqBC,EAArB,CAAb;;AAEAe,UAAQC,MAAR,CAAeT,KAAKT,IAAL,IAAaA,IAA5B;AACAiB,UAAQC,MAAR,CAAeT,KAAKR,IAAL,IAAaA,IAA5B;AACAgB,UAAQC,MAAR,CAAeT,KAAKP,EAAL,IAAWA,EAA1B;;AAEAmB,QAAMT,MAAN,CAAaH,IAAb;AACAQ,UAAQC,MAAR,CAAeG,MAAMC,GAAN,CAAUb,KAAKJ,EAAf,KAAsBI,IAArC;AACD;;AAED;AACE,MAAMY,SAAQ,qBAAd;AACA,MAAMrB,QAAO,oBAAb;AACA,MAAMC,QAAO,oBAAb;AACA,MAAMC,MAAK,oBAAX;AACA,MAAMO,QAAOY,OAAME,GAAN,CAAUvB,KAAV,EAAgBC,KAAhB,EAAsBC,GAAtB,CAAb;;AAEAe,UAAQC,MAAR,CAAeT,MAAKT,IAAL,IAAaA,KAA5B;AACAiB,UAAQC,MAAR,CAAeT,MAAKR,IAAL,IAAaA,KAA5B;AACAgB,UAAQC,MAAR,CAAeT,MAAKP,EAAL,IAAWA,GAA1B;AACAe,UAAQC,MAAR,CAAeT,MAAKH,EAAL,IAAWU,SAA1B;AACAC,UAAQC,MAAR,CAAeG,OAAMC,GAAN,CAAUb,MAAKJ,EAAf,KAAsBI,KAArC;AAED;;AAED;AACE,MAAMY,UAAQ,qBAAd;AACA,MAAMrB,SAAO,oBAAb;AACA,MAAMC,SAAO,oBAAb;AACA,MAAMC,OAAK,oBAAX;AACA,MAAMC,QAAQ,oBAAd;AACA,MAAMM,SAAOY,QAAME,GAAN,CAAUvB,MAAV,EAAgBC,MAAhB,EAAsBC,IAAtB,EAA0BC,KAA1B,CAAb;AACAc,UAAQC,MAAR,CAAeT,OAAKT,IAAL,IAAaA,MAA5B;AACAiB,UAAQC,MAAR,CAAeT,OAAKR,IAAL,IAAaA,MAA5B;AACAgB,UAAQC,MAAR,CAAeT,OAAKP,EAAL,IAAWA,IAA1B;AACAe,UAAQC,MAAR,CAAeT,OAAKH,EAAL,IAAWH,KAA1B;AACAc,UAAQC,MAAR,CAAeG,QAAMC,GAAN,CAAUb,OAAKJ,EAAf,KAAsBI,MAArC;AACD;;AAEDQ,QAAQO,GAAR,CAAY,sBAAZ,E;;;;;;;;;;;;;;;;;;;ACpDA;;;;;;AAEO,IAAMC,oDAAsB,oBAA5B,C","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap a24e4bff588b71026c5c","export default class UUID {\n  static generateUUIDString() {\n    // UUID ver 4 / RFC 4122\n    var uuid = \"\", i, random;\n    for (i = 0; i < 32; i++) {\n      random = Math.random() * 16 | 0;\n      \n      if (i == 8 || i == 12 || i == 16 || i == 20) {\n        uuid += \"-\"\n      }\n      uuid += (i == 12 ? 4 : (i == 16 ? (random & 3 | 8) : random)).toString(16);\n    }\n    return uuid;\n  }\n  \n  constructor() {\n    this.origin = this.constructor.generateUUIDString();\n  }\n  \n  get urn() {\n    return \"urn:uuid:\" + this.origin;\n  }\n  \n  toString() {\n    return this.origin;\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/uuid.js","import UUID from './uuid'\n\nexport default class Link {\n  constructor(type, from, to, place, transaction, id=new UUID()) {\n    this.id = id;\n    this.type = type;\n    this.from = from;\n    this.to = to;\n    this.in = place;\n    this.transaction = transaction;\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/link.js","import UUID from './uuid';\nimport Link from './link';\nimport { transactionTimeUUID as transactionTime } from './ontology';\n\nexport default class Store {\n  constructor() {\n    this.links = {};\n  }\n  \n  get(id) {\n    return this.links[id];\n  }\n  \n  set(id, link) {\n    this.links[id] = link;\n  }\n\n  append(link) {\n    this.set(link.id, link);\n  }\n  \n  addLink(type, from, to, place, tid) {\n    const link = new Link(type, from, to, place, tid);\n    this.append(link);\n    return link;\n  }\n  \n  transaction(block) {\n    // todo: アトミックな操作に修正する\n    const tid = new UUID();\n    this.addLink(transactionTime, tid, new Date(), undefined, tid);\n    return block(tid);\n  }\n  \n  add(type, from, to, place) {\n    return this.transaction(tid =>\n      this.addLink(type, from, to, place, tid)\n    );\n  }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/store.js","import UUID from './uuid';\nimport Link from './link';\nimport Store from './store';\n\n{\n  console.assert(new UUID().urn.match(/^urn:uuid:.*$/));\n}\n\n{\n  const store = new Store();\n  const type = new UUID();\n  const from = new UUID();\n  const to = new UUID();\n  const link = new Link(type, from, to);\n\n  console.assert(link.type == type);\n  console.assert(link.from == from);\n  console.assert(link.to == to);\n  \n  store.append(link);\n  console.assert(store.get(link.id) == link);\n}\n\n{\n  const store = new Store();\n  const type = new UUID();\n  const from = new UUID();\n  const to = new UUID();\n  const link = store.add(type, from, to);\n\n  console.assert(link.type == type);\n  console.assert(link.from == from);\n  console.assert(link.to == to);\n  console.assert(link.in == undefined);\n  console.assert(store.get(link.id) == link);\n  \n}\n\n{\n  const store = new Store();\n  const type = new UUID();\n  const from = new UUID();\n  const to = new UUID();\n  const place = new UUID();\n  const link = store.add(type, from, to, place);\n  console.assert(link.type == type);\n  console.assert(link.from == from);\n  console.assert(link.to == to);\n  console.assert(link.in == place);\n  console.assert(store.get(link.id) == link);\n}\n\nconsole.log(\"all tests succeeded.\");\n\n\n// WEBPACK FOOTER //\n// ./src/app.js","import UUID from './uuid';\n\nexport const transactionTimeUUID = new UUID()\n\n\n\n// WEBPACK FOOTER //\n// ./src/ontology.js"],"sourceRoot":""}